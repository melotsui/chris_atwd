<!DOCTYPE html>
<html lang="en">

<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Responsive Admin &amp; Dashboard Template based on Bootstrap 5">
	<meta name="author" content="AdminKit">
	<meta name="keywords" content="adminkit, bootstrap, bootstrap 5, admin, dashboard, template, responsive, css, sass, html, theme, front-end, ui kit, web">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">


	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link rel="shortcut icon" href="img/icons/icon-48x48.png" />

	<link rel="canonical" href="https://demo-basic.adminkit.io/" />

	<title>ATWD Market</title>

	<link href="css/app.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

	<script type="text/javascript">

        var request = new XMLHttpRequest();
        var requestMarket = new XMLHttpRequest();
        var requestField = new XMLHttpRequest();
        var resultArray;
        var html;
		// Search By Region
        function clickRegion() {
			console.log('clickRegion');
            var Region_e = document.getElementById("Region_e").value;
			console.log('clickRegion: ' + Region_e);
            var url = path+"/market/index.php/market/Region_e/" + Region_e;

			if(Region_e == ''){
				document.getElementById('headerDistrict').style.display = "none";
				document.getElementById('bodyDistrict').style.display = "none";
			}else{
				document.getElementById('headerDistrict').style.display = "block";
				document.getElementById('bodyDistrict').style.display = "block";
			}

            requestMarket.open("GET", url, true);  // true=>asynchronous, false=>synchronous
            requestMarket.onreadystatechange = updateMarketByRegion;
            requestMarket.send(null);

        }

		function updateMarketByRegion() {   // callback
            if (requestMarket.readyState == 4) {
                if (requestMarket.status == 200) {
					console.log('updateMarketByRegion' + request.status);
                    var serverData = requestMarket.responseText;
                    // displayArea.innerHTML = serverData;
                    var resultArray = JSON.parse(serverData);
					var html = '';
					for(item of resultArray){
						html += '<tr>';
						html += '<td class="d-none d-md-table-cell">'+item['Region_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['District_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Market_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Address_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Business_Hours_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Contact_1']+' '+item['Contact_2']+'</td>';
						html += '<td class="d-none d-md-table-cell"><div class="mb-2" style="text-align: center;"><a href="" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal" onclick="return false;">';
						html += '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2 align-middle me-2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>';
						html += '</a></div></td></tr>';
					}
					document.getElementById('dataBody').innerHTML = html;
                }
				
            }
        }

		function changeDistrict(){
			console.log('changeDistrict');
            var Region_e = document.getElementById("Region_e").value;
			console.log(Region_e);
            var url = path+"/market/index.php/market/field/region/" + Region_e;


            requestField.open("GET", url, true);  // true=>asynchronous, false=>synchronous
            requestField.onreadystatechange = updateDistrictByRegion;
            requestField.send(null);
		}

		function updateDistrictByRegion() {   // callback
            if (requestField.readyState == 4) {
                if (requestField.status == 200) {
					console.log(requestField.status);
                    var serverData = requestField.responseText;
                    // displayArea.innerHTML = serverData;
                    var resultArray = JSON.parse(serverData);
					var html = '<option value="" selected>Please Select District</option>';
					for(item of resultArray){
						html += '<option value="'+item['District_e']+'">';
						html +=	item['District_e'];
						html +=	'</option>';
					}
					document.getElementById('District_e').innerHTML = html;
                }
				
            }
        }
		// End Search By Region

		// Search By District

        function clickDistrict() {
			console.log('clickRegion');
            var District_e = document.getElementById("District_e").value;
			console.log(Region_e);
            var url = path+"/market/index.php/market/District_e/" + District_e;


            requestMarket.open("GET", url, true);  // true=>asynchronous, false=>synchronous
            requestMarket.onreadystatechange = updateMarketByRegion;
            requestMarket.send(null);

        }

		function updateMarketByDistrict() {   // callback
            if (requestMarket.readyState == 4) {
                if (requestMarket.status == 200) {
					console.log(requestMarket.status);
                    var serverData = requestMarket.responseText;
                    // displayArea.innerHTML = serverData;
                    resultArray = JSON.parse(serverData);
					var html = '';
					for(item of resultArray){
						html += '<tr>';
						html += '<td class="d-none d-md-table-cell">'+item['Region_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['District_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Market_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Address_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Business_Hours_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Contact_1']+' '+item['Contact_2']+'</td>';
						html += '<td class="d-none d-md-table-cell"><div class="mb-2" style="text-align: center;">';
						html += '<a href="" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal" onclick="clickDeleteIcon('+"'"+item['Market_e']+"'"+');return false;">';
						html += '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2 align-middle me-2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>';
						html += '</a></div></td></tr>';
					}
					document.getElementById('dataBody').innerHTML = html;
                }
				
            }
        }

		// End Search By District

		// Search By TC
		function clickTC(){

		}

		// End Search By TC

		// Delete Icon
		function clickDeleteIcon(market_e){

		}
		// End Delete Icon
    </script>
</head>

<body >
	<div class="wrapper">
		<nav id="sidebar" class="sidebar js-sidebar" >
			<div class="sidebar-content js-simplebar">
				<a class="sidebar-brand" href="index.html">
		  <span class="align-middle">ATWD</span>
		</a>
	
		<div class="row" >
			<div class="col-12 col-lg-12" >
				<div class="card">
					<div class="card-header">
						<h5 class="card-title mb-0">Region</h5>
					</div>
					<div class="card-body">
						<select class="form-select mb-3" id="Region_e" onchange="clickRegion(); changeDistrict(); return false;">
						<option value="" selected>Please Select Region</option>
						<option value="Hong Kong & Islands" >Hong Kong & Islands</option>
						<option value="Kowloon" >Kowloon</option>
						<option value="New Territories" >New Territories</option>
					</select>
					</div>
					<div class="card-header" id="headerDistrict" style="display: none;">
						<h5 class="card-title mb-0">District
					</div>
					<div class="card-body" id="bodyDistrict" style="display: none;">
						<select class="form-select mb-3" id="District_e" onchange="clickDistrict(); return false;">
						<option selected>Please Select District</option>
						<option href="javascript:setDistrict('CW');">One</option>
						<option href="javascript:setDistrict('CW');">Two</option>
						<option href="javascript:setDistrict('CW');">Three</option>
					</select>
					</div>
					<div class="card-header" id="headerMarket" style="display: none;">
						<h5 class="card-title mb-0">Market
					</div>
					<div class="card-body"id="bodyMarket" style="display: none;">
						<select class="form-select mb-3" id="Market_e">
						<option selected>Please Select Market</option>
						<option>One</option>
						<option>Two</option>
						<option>Three</option>
					</select>
					</div>
					<div class="card-header">
						<h5 class="card-title mb-0">Commodity
					</div>
					<div class="card-body">
						<select class="form-select mb-3" id="Tenancy_Commodity_e" onchange="clickTC(); return false;">
						<option selected>Please Select Commodity</option>
						<option>One</option>
						<option>Two</option>
						<option>Three</option>
					</select>
					</div>
				</div>
			</div>
		</div>
	
	
		</nav>
	
		<div class="main">
			<nav class="navbar navbar-expand navbar-light navbar-bg">
				<a class="sidebar-toggle js-sidebar-toggle">
		  <i class="hamburger align-self-center"></i>
		</a>
		
				<div class="navbar-collapse collapse">
					<ul class="navbar-nav navbar-align">
						<li class="nav-item dropdown">
		
						</li>
					</ul>
				</div>
			</nav>
		
			<main class="content">
				<div class="container-fluid p-0">
					<h1 class="h3 mb-3"><strong>Market</strong> List</h1>
					</div>


	<div class="row">
		<div class="col-12 col-lg-12 col-xxl-12	 d-flex">
			<div class="card flex-fill" >
				<div class="card-header">

					<!-- <h5 class="card-title mb-0">Click to view details</h5> -->
				</div>
				<table class="table table-hover my-0" id="dataTable">
					<thead>
						<tr>
							<th class="d-none d-md-table-cell">Region</th>
							<th class="d-none d-md-table-cell">District</th>
							<th class="d-none d-md-table-cell">Market</th>
							<th class="d-none d-md-table-cell">Address</th>
							<th class="d-none d-md-table-cell">Business Hours</th>
							<th class="d-none d-md-table-cell">Contact</th>
							<th class="d-none d-md-table-cell">Action</th>
						</tr>
					</thead>
					<tbody id="dataBody">
						<tr>
							<td>Project Apollo</td>
							<td class="d-none d-xl-table-cell">01/01/2021</td>
							<td >31/06/2021</td>
							<td><span class="badge bg-success">Done</span></td>
							<td >Vanessa Tucker</td>
							<td >
								<div class="mb-2">
									<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2 align-middle me-2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>

</main>


<!-- modal for confirmation of delete operation-->
<div class="modal fade " id="confirmDeleteModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
aria-labelledby="confirmDeleteModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" style="width:100%;">
    <div class="modal-content ">
      <div class="modal-header">
          <h5 class="modal-title" id="confirmDeleteModalLabel">Please confirm your deletion</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <!-- <div class="input-group mb-2">
            <span class="input-group-text col-sm-4" id="basic-addon1">Market ID</span>
            <input type="text" class="form-control col-sm-8" aria-describedby="basic-addon1" id="modalMarketID" readonly>
        </div> -->
		<div class="row">
			<div class="input-group mb-2" style="display: none;">
				<span class="input-group-text col-sm-3" id="basic-addon1">Market ID</span>
				<input type="text" class="form-control col-sm-9" aria-describedby="basic-addon1" id="modalMarketID" readonly>
			</div>
			<div class="col-lg-6"> <!-- col-lg-6 -->
				<div class="row g-3">
					<div class="col-12">
					<label for="modalName_e" class="form-label">Market Name</label>
					<input type="text" class="form-control" id="modalName_e" readonly>
					</div>
					<div class="col-12">
					<label for="modalRegion_e" class="form-label">Region</label>
					<input type="password" class="form-control" id="modalRegion_e" readonly>
					</div>
					<div class="col-12">
					<label for="modalAddress_e" class="form-label">Address</label>
					<input type="password" class="form-control" id="modalAddress_e" readonly>
					</div>
					<div class="col-12">
					<label for="modalAddress_e" class="form-label">Business Hours</label>
					<input type="password" class="form-control" id="modalAddress_e" readonly>
					</div>
					<div class="col-12">
					<label for="modalContact_1" class="form-label">Contact 聯絡電話 1</label>
					<input type="password" class="form-control" id="modalContact_1" readonly>
					</div>
				</div>
				
				<div class="input-group mb-4">
					
				</div>    
				
			</div> <!-- End col-lg-6 -->

			<div class="col-lg-6"> <!-- col-lg-6 -->
				<div class="row g-3">
					<div class="col-12">
						<label for="modalName_c" class="form-label">街市</label>
						<input type="email" class="form-control" id="modalName_c" readonly>
					</div>
					<div class="col-12">
						<label for="modalRegion_c" class="form-label">區域</label>
						<input type="text" class="form-control" id="modalRegion_c" readonly>
					</div>
					<div class="col-12">
						<label for="modalAddress_c" class="form-label">地址</label>
						<input type="text" class="form-control" id="modalAddress_c" readonly>
					</div>
					<div class="col-12">
						<label for="modalBH_c" class="form-label">營業時間</label>
						<input type="text" class="form-control" id="modalBH_c" readonly>
					</div>
					<div class="col-12">
					<label for="modalContact_2" class="form-label">Contact 聯絡電話 2</label>
					<input type="password" class="form-control" id="modalContact_2" readonly>
					</div>
				</div>  
			</div> <!-- End col-lg-6 -->
			<div class="col-12">
				<div id="map-container-google-2" class="z-depth-1-half map-container" style="height:100%;">
					<iframe src="https://maps.google.com/maps?q=22.292323,114.199405&t=&z=13&ie=UTF8&iwloc=&output=embed" frameborder="0"
						style="border:0;height:auto;width:100%;" allowfullscreen ></iframe>
				</div>   
			</div>
			<div class="col-12" id="modal_tc">
	
				<table class="table table-hover my-0">
					<thead>
						<!-- <th scope="col"><div class="icon"><i class="bi bi-plus-circle"></i></div></th> -->
						<th scope="col">Tenancy Commodity</th>
						<th scope="col"></th>
						<th scope="col">Nos Stall</th>
					</thead>
					<tbody>
						<tr>
							<!-- <td><input class="form-check-input" type="checkbox" id="modalCheckBoxTC_e" value="'+rs['Data']['Tenancy_Commodity'][i]['Tenancy_Commodity_e']+'" checked></td> -->
							<td><label class="form-check-label" for="modalCheckBoxTC_e">modal CheckBox TC_e</label></td>
							<td><label class="form-check-label" for="modalCheckBoxTC_c">modal CheckBox TC_c</label></td>
							<td><label class="form-check-label" for="modalNosStall">999</label></td>
						</tr>
						<tr>
							<!-- <td><input class="form-check-input" type="checkbox" id="modalCheckBoxTC_e" value="'+rs['Data']['Tenancy_Commodity'][i]['Tenancy_Commodity_e']+'" checked></td> -->
							<td><label class="form-check-label" for="modalCheckBoxTC_e">modal CheckBox TC_e</label></td>
							<td><label class="form-check-label" for="modalCheckBoxTC_c">modal CheckBox TC_c</label></td>
							<td><label class="form-check-label" for="modalNosStall">999</label></td>
						</tr>
						<tr>
							<!-- <td><input class="form-check-input" type="checkbox" id="modalCheckBoxTC_e" value="'+rs['Data']['Tenancy_Commodity'][i]['Tenancy_Commodity_e']+'" checked></td> -->
							<td><label class="form-check-label" for="modalCheckBoxTC_e">modal CheckBox TC_e</label></td>
							<td><label class="form-check-label" for="modalCheckBoxTC_c">modal CheckBox TC_c</label></td>
							<td><label class="form-check-label" for="modalNosStall">999</label></td>
						</tr>
						<tr>
							<!-- <td><input class="form-check-input" type="checkbox" id="modalCheckBoxTC_e" value="'+rs['Data']['Tenancy_Commodity'][i]['Tenancy_Commodity_e']+'" checked></td> -->
							<td><label class="form-check-label" for="modalCheckBoxTC_e">modal CheckBox TC_e</label></td>
							<td><label class="form-check-label" for="modalCheckBoxTC_c">modal CheckBox TC_c</label></td>
							<td><label class="form-check-label" for="modalNosStall">999</label></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div> 


        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="btnModalCancel">Cancel</button>
            <!-- <button type="button" class="btn btn-primary" id="modalAddButton" onclick="goAdd()">Add</button>
            <button type="button" class="btn btn-primary" id="modalUpdateButton" onclick="goUpdate()">Update</button> -->
            <button type="button" class="btn btn-primary" id="modalDeleteButton" onclick="goDelete()">Delete</button>
        </div>
      </div>
    </div>
  </div>
</div>

<footer class="footer">

</footer>


</div>
</div>

	<script src="js/app.js"></script>
	<script type="text/javascript">

		
		var path = location.protocol + "//" + location.hostname + ":" + location.port;

		$(function(){
			listMarket();
			loadTC();
		});
		var request = new XMLHttpRequest();
		var rsArray;
		function listMarket(){
			var url=path+'/market/index.php/market/all';
			request.open("GET", url, true);
			request.onreadystatechange=updateTable;
			request.send(null);
		}

		function updateTable(){
			if(request.readyState==4){
				if(request.status==200){
					var serverData = request.responseText;
					// console.log(serverData);
					rsArray = JSON.parse(serverData);
					var html = '';
					for(item of rsArray){
						html += '<tr>';
						html += '<td class="d-none d-md-table-cell">'+item['Region_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['District_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Market_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Address_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Business_Hours_e']+'</td>';
						html += '<td class="d-none d-md-table-cell">'+item['Contact_1']+' '+item['Contact_2']+'</td>';
						html += '<td class="d-none d-md-table-cell"><div class="mb-2" style="text-align: center;"><a href="" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal" onclick="clickDeleteIcon('+"'"+item['Market_e']+"'"+');return false;">';
						html += '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2 align-middle me-2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>';
						html += '</a></div></td></tr>';
					}
					document.getElementById('dataBody').innerHTML = html;
					// console.log(html);
				}
			}
		}

		function loadTC(){
			console.log('loadTC');
            var url = path+"/market/index.php/market/field/tc";


            requestField.open("GET", url, true);  // true=>asynchronous, false=>synchronous
            requestField.onreadystatechange = updateTC;
            requestField.send(null);
		}

		function updateTC() {   // callback
            if (requestField.readyState == 4) {
                if (requestField.status == 200) {
					console.log(requestField.status);
                    var serverData = requestField.responseText;
                    // displayArea.innerHTML = serverData;
                    var resultArray = JSON.parse(serverData);
					var html = '<option value="" selected>Please Select Commodity</option>';
					for(item of resultArray){
						html += '<option value="'+item['Tenancy_Commodity_e']+'">';
						html +=	item['Tenancy_Commodity_e'];
						html +=	'</option>';
					}
					document.getElementById('Tenancy_Commodity_e').innerHTML = html;
                }
				
            }
        }
	</script>

</body>

</html>


